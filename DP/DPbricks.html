<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DP Bricks v3.5 - Identidad Institucional SER</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* Importación de tipografías oficiales según manual */
        @import url('https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Cabin:ital,wght@0,400;0,500;0,600;0,700;1,400&display=swap');
        
        :root {
            --ser-magenta: #E11B7E;
            --ser-yellow: #FCCC32;
            --ser-cyan: #009BD1;
            --ser-dark: #1a1a1a;
        }

        body {
            font-family: 'Cabin', sans-serif;
            background-color: #0a0a0a;
            color: #f5f5f5;
            overflow-x: hidden;
        }

        h1, h2, h3, h4, .font-bebas {
            font-family: 'Bebas Neue', cursive;
            letter-spacing: 0.05em;
        }

        /* Scrollbar Personalizada */
        .custom-scrollbar::-webkit-scrollbar { height: 8px; width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #121212; border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #444; }

        /* Estilo de Rompecabezas (Puzzle Clip-Path) */
        .puzzle-piece {
            clip-path: path('M 0 0 L 120 0 Q 135 0 135 15 L 135 30 Q 145 40 135 50 L 135 75 Q 135 90 120 90 L 0 90 Q 10 75 10 50 Q 0 40 10 30 Q 10 15 0 0 Z');
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .active-brick {
            filter: brightness(1.2) contrast(1.1);
            transform: scale(1.05) translateY(-5px);
            box-shadow: 0 0 40px rgba(225, 27, 126, 0.3);
            z-index: 50 !important;
        }

        .brick-transition {
            transition: transform 0.2s, opacity 0.2s, filter 0.2s;
        }
        
        @keyframes popIn {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        .animate-pop { animation: popIn 0.3s ease-out forwards; }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Header con Identidad SER -->
    <header class="p-4 md:p-6 border-b border-neutral-800 bg-neutral-900/80 backdrop-blur-xl sticky top-0 z-50">
        <div class="max-w-7xl mx-auto flex items-center justify-between">
            <div class="flex items-center gap-4">
                <div class="bg-[#E11B7E] p-2.5 rounded-lg shadow-lg shadow-magenta-500/20">
                    <i data-lucide="zap" class="text-white fill-current w-6 h-6"></i>
                </div>
                <div>
                    <h1 class="text-2xl text-white leading-none">SER <span class="text-[#009BD1] ml-1">DP BRICKS</span></h1>
                    <p class="text-[10px] text-neutral-500 uppercase tracking-[0.4em] font-bold">Superación | Excelencia | Resultados</p>
                </div>
            </div>
            <div class="flex items-center gap-3">
                <button id="shuffle-btn" class="flex items-center gap-2 px-5 py-2 bg-neutral-800 hover:bg-neutral-700 text-white rounded-full text-xs font-bold uppercase tracking-widest transition-all border border-neutral-700">
                    <i data-lucide="shuffle" class="w-4 h-4"></i> <span>Revolver</span>
                </button>
            </div>
        </div>
    </header>

    <main class="flex-1 flex flex-col p-4 md:p-6 gap-6 max-w-7xl mx-auto w-full">
        
        <!-- Toolbox -->
        <section id="toolbox-section" class="bg-neutral-900/40 p-5 rounded-[2rem] border border-neutral-800 shadow-inner">
            <div class="mb-5 px-2">
                <h2 class="text-lg text-neutral-400 uppercase tracking-widest flex items-center gap-2">
                    <i data-lucide="package" class="text-[#FCCC32] w-5 h-5"></i> Librería de Facilitación
                </h2>
            </div>

            <div id="library-grid" class="grid grid-cols-2 md:grid-cols-5 gap-4">
                <!-- Se genera vía JS -->
            </div>
        </section>

        <!-- Pipeline (Lienzo) -->
        <section class="flex-1 bg-neutral-900/20 border-2 border-dashed border-neutral-800 rounded-[3rem] p-10 flex flex-col shadow-inner min-h-[260px] overflow-hidden relative">
            <div class="flex items-center justify-between mb-6 px-6">
                <h2 class="text-sm font-bold text-neutral-500 uppercase tracking-[0.3em]">Pipeline de la Sesión</h2>
                <button id="clear-canvas" class="text-xs text-red-500/70 hover:text-red-500 font-bold uppercase tracking-widest flex items-center gap-1 transition-colors">
                    <i data-lucide="trash-2" class="w-4 h-4"></i> Borrar Todo
                </button>
            </div>
            
            <div id="timeline-container" class="flex-1 overflow-x-auto flex items-center custom-scrollbar px-10 min-h-[140px]">
                <!-- Las piezas se inyectan aquí -->
            </div>
        </section>

        <!-- Análisis e Inspector -->
        <section class="grid grid-cols-1 lg:grid-cols-2 gap-6 h-[420px] mb-10">
            <!-- Terminal Debugger -->
            <div class="bg-neutral-900 border border-neutral-800 rounded-[2rem] p-7 shadow-xl flex flex-col overflow-hidden relative">
                <h3 class="text-xs font-bold text-neutral-500 uppercase tracking-[0.3em] mb-5 flex items-center gap-2 relative z-10">
                    <i data-lucide="binary" class="text-[#E11B7E] w-4 h-4"></i> Pedagogical Debugger
                </h3>
                <div id="debugger-console" class="flex-1 overflow-y-auto space-y-3 pr-2 custom-scrollbar relative z-10">
                    <!-- Logs dinámicos -->
                </div>
            </div>

            <!-- Inspector Panel -->
            <div id="inspector-panel" class="bg-neutral-900 border border-neutral-800 rounded-[2rem] p-7 shadow-xl overflow-hidden flex flex-col">
                <!-- Data enriquecida JS -->
            </div>
        </section>
    </main>

    <footer class="p-4 text-center bg-black border-t border-neutral-900 text-[9px] text-neutral-600 font-bold uppercase tracking-[0.5em]">
        Pipeline Logic Engine • SER Network Identity • Puzzle Architecture v3.5
    </footer>

    <script>
        // --- COLORES SEGÚN MANUAL ---
        const CATEGORIES = {
            EJECUCION: { id: 'EJECUCION', label: 'Ejecución', color: 'text-[#E11B7E]', brickClass: 'bg-[#E11B7E]', hoverClass: 'hover:bg-[#f02d8e]' },
            VER: { id: 'VER', label: 'Ver', color: 'text-[#009BD1]', brickClass: 'bg-[#009BD1]', hoverClass: 'hover:bg-[#00b4f0]' },
            NOMBRAR: { id: 'NOMBRAR', label: 'Nombrar', color: 'text-[#FCCC32]', brickClass: 'bg-[#FCCC32]', hoverClass: 'hover:bg-[#fdd658]' },
            HACER: { id: 'HACER', label: 'Hacer', color: 'text-[#FCCC32]', brickClass: 'bg-[#FCCC32]', hoverClass: 'hover:bg-[#fdd658]' },
            REFLEXIONAR: { id: 'REFLEXIONAR', label: 'Reflexionar', color: 'text-[#009BD1]', brickClass: 'bg-[#009BD1]', hoverClass: 'hover:bg-[#00b4f0]' }
        };

        const BRICK_DEFS = {
            OBJETIVO: { 
                id: 'OBJETIVO', 
                category: 'EJECUCION', 
                label: 'Objetivo de Hacer', 
                icon: 'target', 
                description: 'Define qué serán capaces de HACER los docentes. No es saber, es ejecutar.', 
                examples: ['"Los docentes aplicarán una pausa de 3 segundos tras la línea clave"', '"Los líderes modelarán la corrección individual privada"'],
                reflection: '¿Es el objetivo claro, medible y realizable hoy?', 
                bugs: 'Plantear un objetivo de "comprensión" en lugar de uno de "acción".',
                impact: 'Propósito compartido.' 
            },
            HISTORIA: { 
                id: 'HISTORIA', 
                category: 'EJECUCION', 
                label: 'Contar Historia', 
                icon: 'book-open', 
                description: 'Narrativa para conectar. Usa el "nosotros" colectivo.', 
                examples: ['"Acabamos de mirar a alguien haciendo justamente eso..."', '"Vamos a hacer un viaje al aula de 5to grado..."'],
                reflection: '¿Honro la experiencia de los participantes?', 
                bugs: 'Hablar de "yo" o presumir de logros personales en lugar de los del equipo.',
                impact: 'Conexión emocional.' 
            },
            PRESENCIA: { 
                id: 'PRESENCIA', 
                category: 'EJECUCION', 
                label: 'Cara Abierta', 
                icon: 'smile', 
                description: 'Cejas levantadas, mirada a la audiencia y movimientos de manos tranquilos.', 
                examples: ['Modulación de voz para transmitir emoción', 'Romper el plano caminando hacia el grupo'],
                reflection: '¿Mis cejas están surcadas o levantadas?', 
                bugs: 'Mantener un lenguaje corporal cerrado o defensivo.',
                impact: 'Seguridad psicológica.' 
            },
            BOCADO: { 
                id: 'BOCADO', 
                category: 'EJECUCION', 
                label: 'Instrucción Bocado', 
                icon: 'layers', 
                description: 'Dividir instrucciones complejas en pasos pequeños y entregarlos de a uno.', 
                examples: ['"Abran la página 6..." (pausa) -> "Tienen 2 minutos para escribir..."'],
                reflection: '¿Dividí la instrucción en pasos secuenciales?', 
                bugs: 'Dar la instrucción 2 mientras los participantes aún procesan la 1.',
                impact: 'Foco ejecutivo.' 
            },
            ENFOQUE: { 
                id: 'ENFOQUE', 
                category: 'VER', 
                label: 'P. de Enfoque', 
                icon: 'help-circle', 
                description: 'Pregunta previa que dirige la mirada hacia acciones positivas específicas.', 
                examples: ['"¿Qué hace el líder con sus manos mientras el docente habla?"', '"¿Cómo modula su voz durante la corrección?"'],
                reflection: '¿La pregunta enfoca lo positivo que quiero que vean?', 
                bugs: 'Preguntar "¿Qué notaron?" (demasiado abierto, genera ruido).',
                impact: 'Observación útil.' 
            },
            MODELO_VIDEO: { 
                id: 'MODELO_VIDEO', 
                category: 'VER', 
                label: 'Modelo Video', 
                icon: 'video', 
                description: 'Ver un modelo externo de éxito breve (<5 min).', 
                examples: ['Video de un profesor experto aplicando Voz Fuerte', 'Clip de una reunión de análisis de datos efectiva'],
                reflection: '¿El video está probado y puesto en el minuto exacto?', 
                bugs: 'Mostrar videos largos que pierden el punto técnico.',
                impact: 'Validación visual.' 
            },
            GIRA_DISCUTE: { 
                id: 'GIRA_DISCUTE', 
                category: 'NOMBRAR', 
                label: 'Gira y Discute', 
                icon: 'message-square', 
                description: 'Procesamiento en parejas para involucrar a todos en el pensamiento.', 
                examples: ['"Discute con tu pareja: ¿Por qué la pausa fue efectiva?"', '"1 minuto para compartir una gema observada"'],
                reflection: '¿Asigné quién comienza primero?', 
                bugs: 'No monitorear las parejas mientras hablan.',
                impact: 'Ratio de pensamiento.' 
            },
            PREGUNTAR_PORQUE: { 
                id: 'PREGUNTAR_PORQUE', 
                category: 'NOMBRAR', 
                label: 'Preguntar ¿Por qué?', 
                icon: 'zap', 
                description: 'Momento para que el grupo descubra la lógica técnica del modelo.', 
                examples: ['"¿Cuál es el valor de hacer eso?"', '"¿Qué hubiera pasado si no hubiéramos hecho la pausa?"'],
                reflection: '¿Logré que ellos dedujeran el valor antes de nombrarlo?', 
                bugs: 'Responder la pregunta antes de que los participantes piensen.',
                impact: 'Lógica profunda.' 
            },
            NOMBRAR_TECNICO: { 
                id: 'NOMBRAR_TECNICO', 
                category: 'NOMBRAR', 
                label: 'Nombre Técnico', 
                icon: 'type', 
                description: 'Asignar lenguaje formal a la conclusión. Fija la "Idea Central".', 
                examples: ['"A esto le llamamos: Pausa Dramática"', '"Esta técnica es: Lo Correcto es lo Correcto"'],
                reflection: '¿Esperé hasta el final para dar el nombre?', 
                bugs: 'Nombrar la técnica al inicio de la diapositiva.',
                impact: 'Estandarización.' 
            },
            GUION: { 
                id: 'GUION', 
                category: 'HACER', 
                label: 'Hacer Guion', 
                icon: 'pen-tool', 
                description: 'Escribir palabras y señales exactas antes de practicar físicamente.', 
                examples: ['Escribir el guion de corrección de 5 palabras', 'Planear la pregunta de chequeo de comprensión'],
                reflection: '¿Dí tiempo de silencio total para escribir?', 
                bugs: 'Practicar sin tener las palabras escritas (genera bloqueos).',
                impact: 'Práctica segura.' 
            },
            PRACTICA_BRECHA: { 
                id: 'PRACTICA_BRECHA', 
                category: 'HACER', 
                label: 'Práctica Brecha', 
                icon: 'user-round', 
                description: 'Juego de roles enfocado en lo que más cuesta lograr.', 
                examples: ['Simular una clase difícil para practicar el tono', 'Practicar la modulación de voz frente a un par'],
                reflection: '¿Monitoreo con el ejemplar en mano?', 
                bugs: 'Hacer una práctica "light" donde no hay errores que corregir.',
                impact: 'Transferencia física.' 
            },
            DE_NUEVO: { 
                id: 'DE_NUEVO', 
                category: 'HACER', 
                label: 'De Nuevo', 
                icon: 'refresh-ccw', 
                description: 'Repetir la acción incorporando feedback inmediato. Perfeccionamiento.', 
                examples: ['"Eso fue bueno, pero intenta sin usar el nombre. ¡De nuevo!"'],
                reflection: '¿El feedback fue del tamaño de un bocado?', 
                bugs: 'Dar feedback y no repetir la acción.',
                impact: 'Maestría técnica.' 
            },
            REFLEXIONAR: { 
                id: 'REFLEXIONAR', 
                category: 'REFLEXIONAR', 
                label: 'Sellar Aprendizaje', 
                icon: 'pen-tool', 
                description: 'Registro escrito breve de pensamientos y reflexiones clave.', 
                examples: ['"Escriban en su diario las 3 claves de hoy"', '"Reflexiona: ¿Cómo aplicarás esto mañana?"'],
                reflection: '¿Limite la reflexión a 1-2 minutos?', 
                bugs: 'Hacer la reflexión mientras hay ruido o distracciones.',
                impact: 'Anclaje cognitivo.' 
            }
        };

        let sequence = [];
        let selectedIdx = null;
        let previewItem = null;
        let isShuffled = false;
        let libraryKeys = Object.keys(BRICK_DEFS);

        const libContainer = document.getElementById('library-grid');
        const timelineContainer = document.getElementById('timeline-container');
        const debuggerConsole = document.getElementById('debugger-console');
        const inspectorPanel = document.getElementById('inspector-panel');

        function renderLibrary() {
            libContainer.innerHTML = '';
            const keysToRender = isShuffled ? libraryKeys.sort(() => Math.random() - 0.5) : libraryKeys;
            
            if (isShuffled) {
                libContainer.className = 'flex flex-wrap gap-2 animate-pop';
                keysToRender.forEach(k => libContainer.appendChild(createBrickButton(k)));
            } else {
                libContainer.className = 'grid grid-cols-2 md:grid-cols-5 gap-3';
                Object.keys(CATEGORIES).forEach(catKey => {
                    const col = document.createElement('div');
                    col.className = 'space-y-2';
                    col.innerHTML = `<h3 class="text-[10px] font-black uppercase tracking-widest ${CATEGORIES[catKey].color} border-b border-neutral-800 pb-1.5">${CATEGORIES[catKey].label}</h3>`;
                    const list = document.createElement('div');
                    list.className = 'flex flex-col gap-1.5';
                    Object.keys(BRICK_DEFS).filter(k => BRICK_DEFS[k].category === catKey).forEach(k => list.appendChild(createBrickButton(k)));
                    col.appendChild(list);
                    libContainer.appendChild(col);
                });
            }
            lucide.createIcons();
        }

        function createBrickButton(key) {
            const brick = BRICK_DEFS[key];
            const wrap = document.createElement('div');
            wrap.className = 'relative group';
            
            const btn = document.createElement('button');
            const cat = CATEGORIES[brick.category];
            btn.className = `${cat.brickClass} ${cat.hoverClass} w-full py-2.5 px-3 pr-8 rounded-xl flex items-center gap-2 shadow-sm transition-all active:scale-95 text-white border border-white/10 text-left`;
            btn.innerHTML = `<i data-lucide="${brick.icon}" class="w-4 h-4 opacity-90 shrink-0"></i><span class="font-bebas text-xs uppercase tracking-wider truncate">${brick.label}</span>`;
            btn.onclick = () => {
                sequence.push({...brick, instanceId: Math.random()});
                previewItem = null;
                renderTimeline();
                updateAnalysis();
            };
            
            const info = document.createElement('button');
            info.className = 'absolute right-1.5 top-1/2 -translate-y-1/2 p-1 text-white/30 hover:text-white transition-opacity bg-black/10 rounded-full';
            info.innerHTML = '<i data-lucide="info" class="w-3.5 h-3.5"></i>';
            info.onclick = (e) => { e.stopPropagation(); previewItem = brick; selectedIdx = null; updateInspector(); };
            
            wrap.appendChild(btn); wrap.appendChild(info);
            return wrap;
        }

        function renderTimeline() {
            timelineContainer.innerHTML = '';
            if (sequence.length === 0) {
                timelineContainer.innerHTML = '<div class="w-full text-center opacity-20 py-10 font-bold uppercase text-sm tracking-widest italic font-bebas">Suelte Bricks para iniciar la arquitectura</div>';
                return;
            }

            const wrapper = document.createElement('div');
            wrapper.className = 'flex items-center';
            
            sequence.forEach((brick, idx) => {
                const piece = document.createElement('div');
                const cat = CATEGORIES[brick.category];
                piece.className = `relative flex-shrink-0 w-[145px] h-[95px] p-5 transition-all cursor-pointer flex flex-col justify-center puzzle-piece brick-transition ${cat.brickClass} ${selectedIdx === idx ? 'active-brick' : 'z-10 opacity-90 hover:opacity-100 hover:z-20'}`;
                piece.style.marginLeft = idx === 0 ? '0' : '-18px';
                piece.onclick = () => { selectedIdx = idx; previewItem = null; renderTimeline(); updateInspector(); };

                piece.innerHTML = `
                    <div class="flex justify-between items-start mb-1">
                        <div class="bg-black/20 p-1 rounded text-white/80"><i data-lucide="${brick.icon}" class="w-4 h-4"></i></div>
                        <button onclick="event.stopPropagation(); removeBrick(${idx})" class="p-1 bg-black/20 hover:bg-black rounded-full text-white transition-colors">
                            <i data-lucide="trash-2" class="w-3.5 h-3.5"></i>
                        </button>
                    </div>
                    <h4 class="font-bebas text-sm uppercase tracking-wider text-white truncate">${brick.label}</h4>
                `;
                wrapper.appendChild(piece);
            });
            
            timelineContainer.appendChild(wrapper);
            lucide.createIcons();
        }

        function removeBrick(idx) {
            sequence.splice(idx, 1);
            selectedIdx = null;
            renderTimeline(); updateAnalysis(); updateInspector();
        }

        function updateAnalysis() {
            debuggerConsole.innerHTML = '';
            const bugs = [];
            if (sequence.length === 0) return;

            if (!['OBJETIVO', 'HISTORIA'].includes(sequence[0]?.id)) {
                bugs.push({ title: "Falta Cimiento", msg: "La sesión no tiene un marco estratégico.", fix: "Añade [Objetivo] o [Historia] al inicio." });
            }

            sequence.forEach((brick, i) => {
                const prev = sequence[i-1];
                if (['MODELO_VIDEO', 'MODELO_LIDER'].includes(brick.id) && (!prev || prev.id !== 'ENFOQUE')) {
                    bugs.push({ title: "Observación Ciega", msg: `"${brick.label}" carece de dirección visual.`, fix: "Añade [P. de Enfoque] antes." });
                }
                if (brick.id === 'NOMBRAR_TECNICO' && (!prev || (prev.id !== 'GIRA_DISCUTE' && prev.id !== 'PREGUNTAR_PORQUE'))) {
                    bugs.push({ title: "Salto Lógico", msg: "Nombrando antes de permitir el descubrimiento.", fix: "Añade [Gira y Discute] antes." });
                }
                if (brick.id === 'PRACTICA_BRECHA' && (!prev || prev.id !== 'GUION')) {
                    bugs.push({ title: "Falta de Guion", msg: "Práctica física sin planeación previa.", fix: "Añade [Hacer Guion] antes." });
                }
            });

            if (bugs.length === 0) {
                debuggerConsole.innerHTML = `<div class="p-5 text-emerald-400 bg-emerald-400/5 rounded-2xl border border-emerald-400/20 text-xs font-bold uppercase tracking-widest flex gap-3 items-center animate-pop"><i data-lucide="shield-check"></i>Pipeline saludable e institucional.</div>`;
            } else {
                bugs.forEach(bug => {
                    const d = document.createElement('div');
                    d.className = 'p-4 bg-red-500/5 border border-red-500/20 rounded-2xl space-y-2';
                    d.innerHTML = `
                        <div class="flex gap-2 text-red-400 font-bold uppercase text-[10px] items-center"><i data-lucide="alert-triangle" class="w-4 h-4"></i> ${bug.title}</div>
                        <p class="text-xs text-neutral-400">${bug.msg}</p>
                        <div class="text-[9px] bg-indigo-500/10 text-indigo-300 py-1 px-2 rounded-lg border border-indigo-500/10 inline-block font-bold">FIX: ${bug.fix}</div>
                    `;
                    debuggerConsole.appendChild(d);
                });
            }
            lucide.createIcons();
        }

        function updateInspector() {
            const item = selectedIdx !== null ? sequence[selectedIdx] : previewItem;
            inspectorPanel.innerHTML = '';
            
            if (!item) {
                inspectorPanel.innerHTML = '<div class="h-full flex flex-col items-center justify-center opacity-30 text-neutral-600 font-black uppercase text-xs tracking-[0.4em] italic"><i data-lucide="zoom-in" class="w-12 h-12 mb-4"></i>Inspeccionar Elemento</div>';
                lucide.createIcons(); return;
            }

            const cat = CATEGORIES[item.category];
            const examplesHtml = item.examples ? item.examples.map(ex => `<li class="mb-1 text-indigo-100">"${ex}"</li>`).join('') : '<li>N/A</li>';

            inspectorPanel.innerHTML = `
                <div class="h-full flex flex-col custom-scrollbar overflow-y-auto pr-2 animate-pop">
                    <div class="flex items-center gap-4 mb-5 pb-5 border-b border-neutral-800">
                        <div class="p-3.5 rounded-2xl ${cat.brickClass} text-white shadow-2xl"><i data-lucide="${item.icon}" class="w-6 h-6"></i></div>
                        <div>
                            <h3 class="text-xl text-white uppercase tracking-wider">${item.label}</h3>
                            <p class="text-[10px] font-bold uppercase tracking-widest ${cat.color}">${cat.label}</p>
                        </div>
                    </div>
                    
                    <div class="space-y-5">
                        <div class="bg-neutral-950 p-5 rounded-2xl border border-neutral-800 shadow-inner">
                            <p class="text-[9px] font-black text-neutral-500 uppercase tracking-widest mb-2 italic">Definición Técnica</p>
                            <p class="text-sm text-neutral-200 leading-relaxed font-medium">${item.description}</p>
                        </div>

                        <div class="bg-[#009BD1]/5 p-5 rounded-2xl border border-[#009BD1]/10">
                            <p class="text-[9px] font-black text-[#009BD1] uppercase tracking-widest mb-3">Modelos de Facilitación (SER)</p>
                            <ul class="text-xs list-disc list-inside space-y-2 font-medium italic text-neutral-300">
                                ${examplesHtml}
                            </ul>
                        </div>

                        <div class="grid grid-cols-2 gap-4">
                            <div class="bg-[#E11B7E]/5 p-4 rounded-2xl border border-[#E11B7E]/10">
                                <p class="text-[9px] font-black text-[#E11B7E] uppercase tracking-widest mb-1">Bug Típico</p>
                                <p class="text-[10px] text-neutral-400 leading-tight">${item.bugs || 'N/A'}</p>
                            </div>
                            <div class="bg-[#FCCC32]/5 p-4 rounded-2xl border border-[#FCCC32]/10">
                                <p class="text-[9px] font-black text-[#FCCC32] uppercase tracking-widest mb-1">Pauta de Éxito</p>
                                <p class="text-[10px] text-neutral-400 leading-tight">${item.reflection}</p>
                            </div>
                        </div>

                        <div class="flex items-center gap-3 pt-2">
                             <div class="w-2 h-2 rounded-full bg-emerald-500 animate-pulse"></div>
                             <p class="text-xs text-emerald-500 uppercase font-black tracking-widest">Apalancamiento: ${item.impact}</p>
                        </div>
                    </div>
                </div>
            `;
            lucide.createIcons();
        }

        document.getElementById('shuffle-btn').onclick = () => {
            isShuffled = !isShuffled;
            renderLibrary();
        };

        document.getElementById('clear-canvas').onclick = () => {
            sequence = []; selectedIdx = null; previewItem = null;
            renderTimeline(); updateAnalysis(); updateInspector();
        };

        window.onload = () => {
            renderLibrary();
            renderTimeline();
            updateAnalysis();
            updateInspector();
        };
    </script>
</body>
</html>
